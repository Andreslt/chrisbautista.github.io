!function(){"use strict";function t(t){var e=this;this.numPostCardsSent=0,this.currentPage=0,this.render=t.animatePages,this.pages=Object.keys(this.render),this.postcard=t.postcard,this.currentDesign="",this.listeners={intro:function(){$("#enterbtn").off().on("click",function(){e.start()})},mechanics:function(){$("#step1 .Submit").off().on("click",function(){e.nextPage()})},pickScent:function(){$(".scents").off().on("mouseover",function(){-1!==$(this).attr("src").indexOf("pg3-selectcard.png")&&$(this).attr("src","assets/pg3-selectcard-hi.png"),$(this).on("mouseout",function(){$(this).attr("src","assets/pg3-selectcard.png"),$(this).off("mouseout")})}).on("click",function(t){t.preventDefault(),e.postcard.setDesign($(this)[0].alt),$(".preview").attr("src","assets/designs/"+e.postcard.getThumbNail()),$("#hrefFront").attr("href","assets/designs/"+e.postcard.getPostcardZoom()),e.nextPage(),t.stopPropagation(),$(".scents").off()})},details:function(){$("#frmFriend").off().on("click",function(){alert("This should popup a selector from a list of facebook friends")}),$("frm_mobile").on("change",function(){var t=/^[0-9-+]+$/;return t.test($(this).val())?($(this).css("border",""),!0):void $(this).css("border","1px solid red")}),$("#step3 .Submit").off().on("click",function(t){t.preventDefault(),e.nextPage(),t.stopPropagation()})},message:function(){$("#frm_dedication").off().limitMaxlength({onEdit:function(t){$(this).siblings(".charsRemaining").text("Characters remaining: "+t),t>0&&$(this).css("background-color","white")},onLimit:function(){$(this).css("background-color","red")}}),$("#step4 .Submit").off().on("click",function(t){t.preventDefault(),e.nextPage(),t.stopPropagation()})},postcard:function(){$("#step5 .Submit").off().on("click",function(t){t.preventDefault(),alert("post this session to server. save."),e.numPostCardsSent+=1,$("#pg8faq").html("You have successfully sent "+e.numPostCardsSent+" postcard"+(e.numPostCardsSent>1?"s":"")+"."),e.nextPage(),t.stopPropagation()}),helpers.thisPreview({obj:$("#hrefBack"),width:640,height:469,beforeShow:function(){var t=(new Date).toDateString().split(" ");$("#salute").html("Dear "+$("#frm_sendee").val().substr(0,$("#frm_fname").val().indexOf(" ",0))+","),$("#ddate").html(t[1]+" "+t[2]+", "+t[3]),$("#dedicatory").html(""+$("#frm_dedication").val()),$("#close").html($("#frm_closing").val()+",<br />"+$("#frm_sender").val()),$("#From").html("From: "+$("#frm_sender").val()),$("#To").html(""+$("#frm_fname").val()+"<br />"+$("#frm_street").val()+" "+$("#frm_province").val()+" "+$("#frm_zip").val()),console.log(e.postcard.getPostcardBack()),$("#thispostcard").addClass(e.postcard.getPostcardBack())}}),$("#backToStart").off().on("click",function(t){t.preventDefault(),e.restart(),t.stopPropagation()})},summary:function(){$("#newPostcard").off().on("click",function(t){t.preventDefault(),e.reset(),t.stopPropagation()}),$("#share").off().on("click",function(){alert("Trigger facebook Share")})}}}t.prototype={getPage:function(t){return this.pages[t]},nextPage:function(){this.currentPage+=1,this.route(this.currentPage)},route:function(t){var e;t=t||0,this.setCurrentPage(t),e=this.getPage(t),this.render[e](),this.listeners[e]()},init:function(){this.route()},setCurrentPage:function(t){this.currentPage=t},reset:function(){this.route(1),this.route(2)},restart:function(){this.route(2)},start:function(){this.route(1)}},window.Application=t}(),function(){"use strict";var t={intro:function(){function t(t){var n=new Image,a=$("img").map(function(){return $(this).attr("src")});n.src="assets/loading.png",jQuery.imgpreload("assets/loading.png",function(){$("#container").fadeOut(50),$("#msg").fadeOut(50).fadeIn(100),$("#msg").html("<strong>Starting ...</strong>")}),jQuery.imgpreload(a,{each:function(){var t=e[Math.floor(Math.random()*e.length+1)];$("#msg").delay(300).html(t)},all:function(){$("#msg").css("opacity","0"),$("#container").css("opacity","1").fadeIn(400),t()}})}var e=["listing travel plans...","planning activities...","checking local weather...","packing essentials...","checking itinerary...","mapping out route...","clearing schedule...","departing..."];t(function(){$("#msg").remove(),$("#container").addClass("intro"),setTimeout(function(){$("#container").css("opacity","1").fadeIn(400),$("#container").animate({opacity:"1"},{duration:"fast"}),$("#container").fadeIn(400),$("#logo").animate({opacity:"0",scale:0},{duration:"fast"}),$("#welcome").animate({opacity:"0",scale:0},{duration:"fast"}),$("#curtis-name").animate({opacity:"0",scale:0},{duration:"fast"}),$("#enter").animate({opacity:"0",scale:.01,left:"405px",top:"445px"},{duration:"fast"}),$("#jasmine").animate({opacity:"0",scale:1,left:"300px"},{duration:"fast"}),$("#friendtxt").animate({opacity:"0",scale:0},{duration:"fast"}),$("#sign").animate({opacity:"0",scale:0},{duration:"fast"}),$("#logo").animate({opacity:"1",scale:"1"},{duration:"slow",easing:"easeInBack",complete:function(){$("#welcome").animate({opacity:"1",scale:"1"},{duration:"slow",easing:"easeInBack"}),$("#friendtxt").animate({opacity:"1",scale:"1"},{duration:"slow",easing:"easeInBack"}),$("#curtis-name").animate({opacity:"1",scale:"1"},{duration:"slow",easing:"easeInBack"}),$("#sign").animate({opacity:"1",scale:"1"},{duration:"slow",easing:"easeInBack",complete:function(){$("#jasmine").animate({opacity:"1",left:"99px"},{duration:"slow",easing:"easeInBack",complete:function(){$("#enter").delay(800).animate({opacity:"0.3",scale:"1"},{duration:"fast"}).animate({opacity:"1",scale:"1",left:"405px",top:"445px"},{duration:"slow",easing:"easeOutBack"})}})}})}})},1500)})},mechanics:function(){$("#container").fadeOut(10).removeClass("intro").addClass("inside"),$("#container").html($("#insideContent")[0].innerHTML),$("#header-top").fadeOut(10),$("#content").fadeOut(10),helpers.thumbPreview(),setTimeout(function(){$("#container").fadeIn(500,function(){$("#header-top").fadeIn(700),$("#content").fadeIn(1200)})},500)},pickScent:function(){$("#step2, #step3, #step4, #step5, #step6").fadeOut(10).removeClass("hid").addClass("hid"),helpers.fadeScreen($("#step1"),$("#step2"))},details:function(){helpers.fadeScreen($("#step2"),$("#step3"))},message:function(){helpers.fadeScreen($("#step3"),$("#step4"))},postcard:function(){helpers.fadeScreen($("#step4"),$("#step5"))},summary:function(){helpers.fadeScreen($("#step5"),$("#step6"))}};window.PageRender=t}(),function(){var t={setDesign:function(t){this.designName=t,this.design=this.getDesign(t),this.message={}},getThumbNail:function(){return this.design.thumb},getPostcardBack:function(){return this.designName},getPostcardZoom:function(){return this.design.zoom},getDesign:function(t){var e;return"paris"==t?e={back:"back-paris.png",thumb:"paris2-thumb.png",zoom:"paris2.jpg"}:"japan"==t?e={back:"back-japan.png",thumb:"japan1-thumb.png",zoom:"japan1.jpg"}:"rio"==t&&(e={back:"back-rio.png",thumb:"rio1-thumb.png",zoom:"rio1.jpg"}),e}};window.PostCard=t}(),function(){var t=new Application({animatePages:PageRender,postcard:PostCard});t.init()}(),$(function(){var t={mask:function(){$("#container").block({message:null,overlayCSS:{backgroundColor:"#FFF"}})},unmask:function(){$("#container").unblock()},fadeScreen:function(t,e){t.fadeOut(null,"",function(){e.removeClass("hid").fadeIn(500,"",function(){t.addClass("hid")})})},thumbPreview:function(){var t=$(".cbPreview"),e=this;t.off().on("click",function(t){var n,a,i=t.target.parentNode;return t.preventDefault(),$("body").append($("<div></div>").addClass("previewOverlay")),a=document.createElement("img"),a.src=i.href,a.addEventListener("load",function(){var t=[this.width,this.height];n=document.createElement("div"),n.appendChild(a),n.id="imgContainer",n=$(n),$(".previewOverlay").append(n),n.css("top",$(window).height()/2-parseInt(t[1]/2)+"px"),n.css("left",$(window).width()/2-parseInt(t[0]/2)+"px"),n.css("height",a.height+2+"px"),n.append(a),e.addCloseBtn(n)}),!1})},thisPreview:function(t){var e=t.obj,n=this;e.off().on("click",function(e){{var a,i,s;e.target.parentNode}return e.preventDefault(),$("body").append($("<div></div>").addClass("previewOverlay")),$(".previewOverlay").append('<div id="thispostcard"><div id="divleft"><div id="salute">Dear _______________,</div><div id="ddate"></div><div id="dedicatory"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce porttitor consequat nibh, nec euismod risus accumsan ac. Aenean tortor ante,  </p></div><div id="close">Love <br/>  _______________</div></div><div id="divright"><div id="To"></div><div id="From"></div></div></div>'),a=$("#thispostcard"),i=parseInt(a.css("width")),s=parseInt(a.css("height")),a.css("top",$(window).height()/2-parseInt(s/2)+"px"),a.css("left",$(window).width()/2-parseInt(i/2)+"px"),a.css("height",s+2+"px"),n.addCloseBtn(a),t.beforeShow&&t.beforeShow(),!1})},addCloseBtn:function(t){var e=document.createElement("img");e.src="assets/close.png",e.addEventListener("load",function(){[this.width,this.height];this.id="closeBtn",$(".previewOverlay").append(this),$("#closeBtn").css("top",parseInt(t.css("top"))-20+"px"),$("#closeBtn").css("left",parseInt(t.css("left"))+parseInt(t.css("width"))+12+"px")}),$(".previewOverlay").on("click",function(){t.remove(),$(this).remove(),$(this).off()})}};window.helpers=t});